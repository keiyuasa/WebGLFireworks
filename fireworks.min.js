/*
 Use it if you like it
*/
function RGBColor(a){this.ok=!1;"#"==a.charAt(0)&&(a=a.substr(1,6));a=a.replace(/ /g,"");a=a.toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",
darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",
gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",
lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",
oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",
slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},b;for(b in e)a==b&&(a=e[b]);var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,
example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];for(b=0;b<d.length;b++){var g=d[b].process,h=d[b].re.exec(a);h&&(channels=g(h),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=0>this.r||isNaN(this.r)?0:255<this.r?255:this.r;this.g=0>this.g||isNaN(this.g)?0:
255<this.g?255:this.g;this.b=0>this.b||isNaN(this.b)?0:255<this.b?255:this.b;this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var a=this.r.toString(16),d=this.g.toString(16),b=this.b.toString(16);1==a.length&&(a="0"+a);1==d.length&&(d="0"+d);1==b.length&&(b="0"+b);return"#"+a+d+b};this.getHelpXML=function(){for(var a=[],b=0;b<d.length;b++)for(var g=d[b].example,h=0;h<g.length;h++)a[a.length]=g[h];for(var m in e)a[a.length]=m;g=document.createElement("ul");
g.setAttribute("id","rgbcolor-examples");for(b=0;b<a.length;b++)try{var t=document.createElement("li"),u=new RGBColor(a[b]),w=document.createElement("div");w.style.cssText="margin: 3px; border: 1px solid black; background:"+u.toHex()+"; color:"+u.toHex();w.appendChild(document.createTextNode("test"));var z=document.createTextNode(" "+a[b]+" -> "+u.toRGB()+" -> "+u.toHex());t.appendChild(w);t.appendChild(z);g.appendChild(t)}catch(A){}return g}};var groundx=4,groundy=4.8,groundz=8,alfa=.9,texture_image=null,DrawingMethod=null,pindex_ground=0,cindex_ground=0,pattern=1,patternLoop=2,ring_r=.5,ring_g=.5,ring_b=1,graphicLib=null,textureImage=null,texture,img=null,count=0,uniLocation=[],theGroundEffects;function groundEffect(){}function groundEffect(a,e,b,d,g,h){this.start=a;this.end=e;this.life=b;this.ox=d;this.oy=g;this.oz=h;this.time=0;this.active=!0}groundEffect.prototype.setColors=function(a,e,b){this.red=a;this.green=e;this.blue=b};
groundEffect.prototype.draw=function(a,e,b){if(this.time<=this.start||this.time>this.end)return b;for(var d=this.end-this.start,g=this.end-this.time,h=.3*g,p=.1*g,k=3*b,n=4*b,r=0;32>=r;r++){var m=2*Math.PI*r/32,t=Math.sin(m),u=Math.cos(m),m=this.ox+h*t,w=this.oy,z=this.oz+h*u,t=this.ox+p*t,A=this.oy,u=this.oz+p*u,v=this.red*(d-g)/d;0>v&&(v=0);var x=this.green*(d-g)/d;0>x&&(x=0);var y=this.blue*(d-g)/d;0>y&&(y=0);alfa=1;a[k++]=m;a[k++]=w;a[k++]=z;e[n++]=v;e[n++]=x;e[n++]=y;e[n++]=alfa;b++;a[k++]=t;
a[k++]=A;a[k++]=u;e[n++]=v;e[n++]=x;e[n++]=y;e[n++]=alfa;b++}return b};groundEffect.prototype.proceed=function(){this.time++;return this.active=this.time>=this.life?!1:!0};function init_ground(){cindex_ground=pindex_ground=0;pattern=1;patternLoop=2;ring_g=ring_r=.5;ring_b=1;img=textureImage=graphicLib=null;count=0;uniLocation=[];theGroundEffects=[]}function genEffect(a){return new groundEffect(0+35*a,10+35*a,24+35*a,lx[a],ly[a],lz[a])}
function render_ground(a,e,b){cindex_ground=pindex_ground=0;var d=theGroundEffects[b];d.draw(a,e);d.proceed()||(theGroundEffects[b]=genEffect(b));DrawingMethod=1}function set_position_ground(a,e,b){};function color(){this.green=this.red=216;this.blue=48}color.prototype.create=function(a,e,b){this.red=a;this.green=e;this.blue=b};var colors=[];colors[0]=new color;colors[0].create(255,41,33);colors[1]=new color;colors[1].create(249,255,84);colors[2]=new color;colors[2].create(32,255,32);colors[3]=new color;colors[3].create(16,32,255);colors[4]=new color;colors[4].create(255,32,240);colors[4]=new color;colors[4].create(255,32,240);colors[5]=new color;colors[5].create(51,194,255);colors[6]=new color;
colors[6].create(255,194,51);colors[7]=new color;colors[7].create(207,207,207);function Sphere(){this.px=[];this.py=[];this.pz=[];var a,e,b;this.create=function(d,g){this.px=[];this.py=[];this.pz=[];var h=2*d+1,p=4*d,k=0,n;for(n=0;n<h;n++){var r=Math.floor(Math.sin(Math.PI*n/(h-1))*p);0==r&&(r=1);k+=r}for(n=k=0;n<h;n++)if(r=Math.PI*n/(h-1),e=Math.cos(r),b=Math.sin(r),l=Math.floor(b*p),l=Math.floor(Math.sin(Math.PI*n/(h-1))*p),0==l)this.px[k]=0,this.py[k]=0,this.pz[k]=g*e,k++;else for(j=0;j<l;j++)a=2*Math.PI*j/l,this.px[k]=g*b*Math.cos(a),this.py[k]=g*b*Math.sin(a),this.pz[k]=
g*e,k++;this.numStars=k}};var sequence0={author:"Kei Yuasa",created_date:"Dec 12, 2015",body:[{pause:90,spots:[{spot:0,color:"red",velocity:3}]},{pause:50,spots:[{spot:1,color:"gold"}]},{pause:50,spots:[{spot:2,color:"aliceblue"}]},{pause:50,spots:[{spot:3,color:"yellowgreen"}]},{pause:50,spots:[{spot:4,color:"beige"}]},{pause:50,spots:[{spot:5,color:"bisque"}]},{pause:50,spots:[{spot:6,color:"lightsalmon"}]},{pause:50,spots:[{spot:7,color:"lightcoral"}]},{pause:50,spots:[{spot:8,color:"mediumpurple"}]},{pause:50,spots:[{spot:9,
color:"turquoise"}]},{pause:50,spots:[{spot:10,color:"tomato"}]},{pause:50,spots:[{spot:11,color:"blue"}]},{pause:50,spots:[{spot:0,color:"red"}]},{pause:50,spots:[{spot:1,color:"gold"}]},{pause:50,spots:[{spot:2,color:"aliceblue"}]},{pause:50,spots:[{spot:3,color:"yellowgreen"}]},{pause:50,spots:[{spot:4,color:"beige"}]},{pause:50,spots:[{spot:5,color:"bisque"}]},{pause:50,spots:[{spot:6,color:"lightsalmon"}]},{pause:50,spots:[{spot:7,color:"lightcoral"}]},{pause:50,spots:[{spot:8,color:"mediumpurple"}]},
{pause:50,spots:[{spot:9,color:"turquoise"}]},{pause:50,spots:[{spot:10,color:"tomato"}]},{pause:50,spots:[{spot:11,color:"blue"}]},{pause:100,spots:[{spot:0,color:"crimson"},{spot:6,color:"lightsteelblue"}]},{pause:40,spots:[{spot:1,color:"crimson"},{spot:7,color:"lightsteelblue"}]},{pause:40,spots:[{spot:2,color:"crimson"},{spot:8,color:"lightsteelblue"}]},{pause:40,spots:[{spot:3,color:"crimson"},{spot:9,color:"lightsteelblue"}]},{pause:40,spots:[{spot:4,color:"crimson"},{spot:10,color:"lightsteelblue"}]},
{pause:40,spots:[{spot:5,color:"crimson"},{spot:11,color:"lightsteelblue"}]},{pause:40,spots:[{spot:6,color:"crimson"},{spot:0,color:"lightsteelblue"}]},{pause:40,spots:[{spot:7,color:"crimson"},{spot:1,color:"lightsteelblue"}]},{pause:40,spots:[{spot:8,color:"crimson"},{spot:2,color:"lightsteelblue"}]},{pause:40,spots:[{spot:9,color:"crimson"},{spot:3,color:"lightsteelblue"}]},{pause:40,spots:[{spot:10,color:"crimson"},{spot:4,color:"lightsteelblue"}]},{pause:40,spots:[{spot:11,color:"crimson"},
{spot:5,color:"lightsteelblue"}]},{pause:120,spots:[{spot:0,color:"red"},{spot:4,color:"green"},{spot:8,color:"blue"}]},{pause:40,spots:[{spot:1,color:"red"},{spot:5,color:"green"},{spot:9,color:"blue"}]},{pause:40,spots:[{spot:2,color:"red"},{spot:6,color:"green"},{spot:10,color:"blue"}]},{pause:40,spots:[{spot:3,color:"red"},{spot:7,color:"green"},{spot:11,color:"blue"}]},{pause:200,spots:[{spot:0,color:"blue"},{spot:2,color:"white"},{spot:4,color:"blue"},{spot:6,color:"white"},{spot:8,color:"blue"},
{spot:10,color:"white"}]},{pause:200,spots:[{spot:1,color:"blue"},{spot:3,color:"white"},{spot:5,color:"blue"},{spot:7,color:"white"},{spot:9,color:"blue"},{spot:11,color:"white"}]},{pause:200,spots:[{spot:0,color:"blue",velocity:5},{spot:1,color:"white",velocity:5},{spot:2,color:"blue",velocity:5},{spot:3,color:"white",velocity:5},{spot:4,color:"blue",velocity:5},{spot:5,color:"white",velocity:5},{spot:6,color:"yellow",velocity:5},{spot:7,color:"cornsilk",velocity:5},{spot:8,color:"turquoise",velocity:5},
{spot:9,color:"tomato",velocity:5},{spot:10,color:"lavender",velocity:5},{spot:11,color:"firebrick",velocity:5}]}]};var q=new qtnIV,qt=q.identity(q.create()),loc_fireworks=null,stride_fireworks=null,loc_ground=null,stride_ground=null,mouseOn=!1,mx,my,prg_fireworks=null,pointSize=3,time_shift=12,time=0,timeLoop=240,lx=[],ly=[],lz=[],radius=24,px=1E3,py=-700,pz=-100,pi1=0,pi2=4,pi3=8,f=-40,distance=50,scale=.5,cycle=120,num_points=12;function mouseDown(a){mouseOn=!0;mx=a.clientX;my=a.clientY}function mouseUp(a){mouseOn=!1}
function mouseMove(a){if(mouseOn){var e=c.width,b=c.height,b=1/Math.sqrt(e*e+b*b),e=mx-a.clientX;a=my-a.clientY;var d=Math.sqrt(e*e+a*a),b=2*d*Math.PI*b;1!=d&&(d=1/d,e*=d/4,a*=d/4);q.rotate(b,[e,a,0],qt)}}init_ground();
onload=function(){function a(a){var b=document.getElementById(a);if(b){switch(b.type){case "x-shader/x-vertex":a=d.createShader(d.VERTEX_SHADER);break;case "x-shader/x-fragment":a=d.createShader(d.FRAGMENT_SHADER);break;default:return}d.shaderSource(a,b.text);d.compileShader(a);if(d.getShaderParameter(a,d.COMPILE_STATUS))return a;alert(d.getShaderInfoLog(a))}}function e(a){var b=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,b);d.bufferData(d.ARRAY_BUFFER,new Float32Array(a),d.STATIC_DRAW);d.bindBuffer(d.ARRAY_BUFFER,
null);return b}function b(a,b,e){for(var g in a)d.bindBuffer(d.ARRAY_BUFFER,a[g]),d.enableVertexAttribArray(b[g]),d.vertexAttribPointer(b[g],e[g],d.FLOAT,!1,0,0)}c=document.getElementById("canvas");c.width=800;c.height=800;c.addEventListener("mousedown",mouseDown);c.addEventListener("mouseup",mouseUp);c.addEventListener("mousemove",mouseMove,!0);var d=c.getContext("webgl")||c.getContext("experimental-webgl");d.getParameter(d.ALIASED_POINT_SIZE_RANGE);var g=a("vs"),h=a("fs");prg_fireworks=function(a,
b){var e=d.createProgram();d.attachShader(e,a);d.attachShader(e,b);d.linkProgram(e);if(d.getProgramParameter(e,d.LINK_STATUS))return d.useProgram(e),e;alert(d.getProgramInfoLog(e))}(g,h);loc_fireworks=[];loc_fireworks[0]=d.getAttribLocation(prg_fireworks,"position");loc_fireworks[1]=d.getAttribLocation(prg_fireworks,"color");loc_ground=[];loc_ground[0]=d.getAttribLocation(prg_fireworks,"position");loc_ground[1]=d.getAttribLocation(prg_fireworks,"color");stride_fireworks=[3,4];stride_ground=[3,4];
var p=[],k=[],n=[];n[0]=d.getUniformLocation(prg_fireworks,"mvpMatrix");n[1]=d.getUniformLocation(prg_fireworks,"pointSize");var r=[];r[0]=d.getUniformLocation(prg_fireworks,"mvpMatrix");r[1]=d.getUniformLocation(prg_fireworks,"pointSize");var m=new matIV,t=m.identity(m.create()),u=m.identity(m.create()),w=m.identity(m.create()),z=m.identity(m.create()),A=m.identity(m.create());m.identity(m.create());d.enable(d.DEPTH_TEST);d.depthFunc(d.LEQUAL);var v=0,x=0,y=0;new firework;radius=24;fws=new fireworks;
num_points=12;fws.setup_fireworks(num_points,radius,px,py,pz);var D=sequence0.body,G=D.length,C=0,B=D[C],F=B.pause,E=B.spots;(function(){position=[];color=[];p=[];k=[];d.clearColor(0,0,0,1);d.clearDepth(1);d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT);var a=m.identity(m.create());q.toMatIV(qt,a);var g=2*Math.PI*v/2E3;2E3<=(v+=0)&&(v=0);2020<=(x+=0)&&(x=0);var h=distance*Math.cos(g),g=distance*Math.sin(g);m.lookAt([h,g,f],[px,py,pz],[0,0,-1],u);m.identity(t);m.rotate(t,Math.PI/2,[1,0,0],t);m.scale(t,
[scale,scale,scale],t);m.multiply(z,t,A);m.multiply(u,a,u);m.perspective(45,c.width/c.height,.1,100,w);m.multiply(w,u,z);fws.proceed();for(i=0;i<num_points;i++)p=[],k=[],num=fws.render_triangle_strip(p,k,i),0<num&&(h=e(p),g=e(k),b([h,g],loc_ground,stride_ground),length=p.length,d.uniformMatrix4fv(r[0],!1,A),d.uniform1f(r[1],3),d.drawArrays(d.TRIANGLE_STRIP,0,p.length/3),d.flush());num=fws.render_points(position,color,0);0<num&&(h=e(position),g=e(color),b([h,g],loc_fireworks,stride_fireworks),length=
position.length,d.uniformMatrix4fv(n[0],!1,A),d.uniform1f(n[1],3),d.drawArrays(d.POINTS,0,position.length/3),d.flush());y++;if(y==F){a=E.length;for(i=0;i<a;i++)fws.generate(E[i]);++C>=G&&(C=0);B=D[C];F=B.pause;E=B.spots;y=0}p=[];k=[];setTimeout(arguments.callee,20)})()};function shell(){this.g=this.r=255;this.b=128;this.time=0}function shell(a,e,b,d,g,h,p,k){this.r=64;this.g=255;this.b=64;this.ox=a;this.oy=e;this.oz=b;this.start=h;this.end=p;this.life=k;this.time=h;this.gravity=8E-5;this.shooters=[];a=new Sphere;a.create(d,g);this.numShooter=a.numStars;this.position=[];this.color=[];this.sphere=new Sphere;this.sphere.create(d,g);this.num=this.sphere.numStars;this.time=0;this.active=!0}shell.prototype.setTime=function(a){this.time=a};
shell.prototype.setColors=function(a,e,b){this.r=a;this.g=e;this.b=b};shell.prototype.draw=function(a,e,b){if(this.time<this.start||this.time>this.end)return b;for(var d=this.time-this.start,g=(this.end-this.time)/(.8*(this.end-this.start)),h=3*b,p=4*b,k=0;k<this.num;k++){a[h++]=this.ox+this.sphere.px[k]*d;a[h++]=this.oy+this.sphere.py[k]*d;a[h++]=this.oz+this.sphere.pz[k]*d;var n=this.r*g,r=this.g*g,m=this.b*g;e[p++]=n;e[p++]=r;e[p++]=m;e[p++]=1;b++}return b};
shell.prototype.proceed=function(){this.time++;this.time>=this.life?(this.active=!1,this.time=0):this.active=!0;return this.active};function random_vector(){var a;a=Math.floor(6*Math.random())-3;var e=a/500;a=Math.floor(20*Math.random())-5;var b=-.08+a/400;a=Math.floor(6*Math.random())-3;a/=500;var d=Math.sqrt(e*e+b*b+a*a);return{x:e/d,y:b/d,z:a/d}}
function set_position(a,e){cindex=pindex=0;lindex=Math.floor(time/time_shift);for(var b=0;b<2*num_points;b++){var d=theSet[b];null!=d&&(d.draw(a,e),d.proceed())}}function FireworksSet(a,e){this.numFireworks=a;this.halfTime=e/2;this.half=a/2;this.set1=[];this.set2=[];this.life=e;for(i=0;i<this.half;i++)this.set1[i]=null,this.set2[i]=null}FireworksSet.prototype.numFireworks=function(){return this.numFireworks};
FireworksSet.prototype.render=function(a,e){for(i=cindex=pindex=0;i<this.set1.length;i++)f=this.set1[i],null!=f&&(f.draw(a,e),f.proceed()||(this.set1[i]=null));for(i=0;i<this.set2.length;i++)f=this.set2[i],null!=f&&(f.draw(a,e),f.proceed()||(this.set2[i]=null))};
FireworksSet.prototype.addFireworks=function(a,e){var b=null;e<this.halfTime?(b=this.set1,console.log("create in set1")):(b=this.set2,console.log("create in set2"));for(i=0;i<b.length;i++)if(null==b[i]){lindex=a;level[lindex]=Math.floor(3*Math.random())+2;vlen=.02*level[lindex];lsize=level[lindex];vel=.01*lsize;start=e;end=start+launcher_length;var d=random_vector(),g=d.x*vlen,h=d.y*vlen,d=d.z*vlen;f=new shell(lx[lindex],ly[lindex],lz[lindex],lsize,vel,start,end,life);f.launcher(lx[lindex],ly[lindex],
lz[lindex],g,h,d,start,end,life);f.setColors(175,175,64);f.setTime=0;b[i]=f;console.log("created shell at "+i+", lindex="+lindex+", x="+lx[lindex]+", y="+ly[lindex]+", z="+lz[lindex]);break}};function launcher(a,e,b,d,g,h,p,k,n){this.g=this.r=255;this.b=128;this.ox=a;this.oy=e;this.oz=b;this.start=p;this.end=k;this.life=n;this.shooters=[];level=Math.floor(3*Math.random())+2;level=1;vel=.01;this.sphere=new Sphere;this.sphere.create(level,vel);this.num=this.sphere.numStars;this.gravity=g/(p-n);a=Math.floor(Math.random()*this.sphere.numStars);this.vx=d+this.sphere.px[a];this.vy=g+this.sphere.py[a];this.vz=h+this.sphere.pz[a];this.time=0;this.active=!0;d=this.end-this.start;this.endx=this.ox+
this.vx*d;this.endy=this.oy+(this.vy+this.gravity*d)*d;this.endz=this.oz+this.vz*d}launcher.prototype.setColors=function(a,e,b){this.r=a;this.g=e;this.b=b};launcher.prototype.proceed=function(){this.time++;this.time>=this.life?(this.active=!1,this.time=0):this.active=!0;return this.active};
launcher.prototype.draw=function(a,e,b){if(this.time<this.start||this.time>this.end)return b;for(var d=this.time-this.start,g=(this.end-this.time)/(this.end-this.start)/256,h=3*b,p=4*b,k=0;k<this.num;k++){a[h++]=this.ox+this.vx*d;a[h++]=this.oy+(this.vy+this.gravity*d)*d;a[h++]=this.oz+this.vz*d;var n=this.r*g,r=this.g*g,m=this.b*g;e[p++]=n;e[p++]=r;e[p++]=m;e[p++]=1;b++}return b};this.num_points=0;this.lz=this.ly=this.lx=null;var pz=py=px=radius=0,svel=3;function fireworks(){this.arr=[]}fireworks.prototype.setup_fireworks=function(a,e,b,d,g){this.num_points=a;this.radius=e;px=b;py=d;pz=g;this.lx=[];this.ly=[];this.lz=[];for(a=0;a<this.num_points;a++)b=2*Math.PI*a/this.num_points,e=Math.cos(b),b=Math.sin(b),this.lx[a]=px+this.radius*e,this.ly[a]=py,this.lz[a]=pz+this.radius*b,this.arr[a]=null};
fireworks.prototype.generate=function(a){pi=a.spot;var e;e=null!=a.color?new RGBColor(a.color):new RGBColor("yellow");e.ok||(e=new RGBColor("yellow"));size=a.size;null==size&&(size=3);a=a.velocity;null==a&&(a=3);if(null==this.arr[pi]||!this.arr[pi].isActive()){var b=new firework;b.color=e;b.ssize=size;b.vel=a/10;b.create(this.lx[pi],this.ly[pi],this.lz[pi]);this.arr[pi]=b}};
fireworks.prototype.proceed=function(){for(var a=!0,e=0;e<this.num_points;e++){var b=this.arr[e],d=!0;null!=b&&(d=b.proceed(),a&=d)}return a};fireworks.prototype.render_triangle_strip0=function(a,e){for(var b=0,d=0,g=0;g<this.num_points;g++)null!=this.arr[g]&&(d++,b=this.arr[g].render_triangle_strip(a,e,b));return b};fireworks.prototype.render_triangle_strip=function(a,e,b){var d=0;null!=this.arr[i]&&(d=this.arr[b].render_triangle_strip(a,e,d));return d};
fireworks.prototype.render_points=function(a,e,b){for(var d=0;d<this.num_points;d++)null!=this.arr[d]&&(b+=this.arr[d].render_points(a,e,b));return b};function firework(){this.shell=this.launcher=this.ground=null}var life=200;
firework.prototype.create=function(a,e,b){this.start=0;this.end=30;this.life=life;this.x=a;this.y=e;this.z=b;this.lstart=0;this.lend=40;this.lvx=0;this.lvy=-.9;this.lvz=0;this.red=this.color.r/256;this.green=this.color.g/256;this.blue=this.color.b/256;this.ground=new groundEffect(this.start,this.end,this.life,this.x,this.y,this.z);this.ground.setColors(this.red,this.green,this.blue);this.launcher=new launcher(this.x,this.y,this.z,this.lvx,this.lvy,this.lvz,this.lstart,this.lend,this.life);this.sx=
this.launcher.endx;this.sy=this.launcher.endy;this.sz=this.launcher.endz;this.sstart=50;this.send=90;this.slife=life;this.shell=new shell(this.sx,this.sy,this.sz,this.ssize,this.vel,this.sstart,this.send,this.slife);this.shell.setColors(this.red,this.green,this.blue)};
firework.prototype.proceed=function(){var a=!1,e=!1,b=!1;null!=this.ground&&this.ground.active?this.ground.proceed():a=!0;null!=this.launcher&&this.launcher.active?this.launcher.proceed():e=!0;null!=this.shell&&this.shell.active?this.shell.proceed():b=!0;return a&&e&&b};firework.prototype.isActive=function(){return this.ground.active||this.launcher.active||this.shell.active};
firework.prototype.render_triangle_strip=function(a,e,b){null!=this.ground&&this.ground.active&&(b=this.ground.draw(a,e,b));return b};firework.prototype.render_points=function(a,e,b){null!=this.launcher&&this.launcher.active&&(b=this.launcher.draw(a,e,b));null!=this.shell&&this.shell.active&&(b=this.shell.draw(a,e,b));return b};
